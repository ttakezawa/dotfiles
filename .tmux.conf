# SEE: https://stackoverflow.com/questions/35016458/how-to-write-if-statement-in-tmux-conf-to-set-different-options-for-different-t/40902312#40902312
run-shell "tmux setenv -g TMUX_VERSION $(tmux -V | cut -c 6-)"

# デフォルト2000行なので1万に変更
set-option -g history-limit 10000

# Prefix key.
set -g prefix C-z
unbind C-b
bind C-z send-prefix

# address vim mode switching delay (http://superuser.com/a/252717/65504)
set -s escape-time 0

# Term
set -g default-terminal "screen-256color"
setw -g xterm-keys on

# Status
set -g status-interval 1
set -g status-style fg=black,bg=white
set -g status-left '#[fg=magenta]#S#[default] '
set -g status-right '#[fg=red]%H:%M:%S'
setw -g window-status-current-style fg=white,bg=blue,bold,underscore

# Mouse mode
set -g mouse off

# toggle mouse mode (tmux-2.1)
bind m if "tmux show -g mouse | grep off" \
  "set -gq mouse on ; display mouse:on " \
  "set -gq mouse off; display mouse:off"

# copy mode (add vi like binding)
setw -g mode-keys emacs

if-shell -b 'bash -c "[[ $TMUX_VERSION < 2.4 ]]"' \
  'bind -t emacs-copy C-u page-up ; \
   bind -t emacs-copy C-d page-down ; \
   bind -t emacs-copy h cursor-left ; \
   bind -t emacs-copy j cursor-down ; \
   bind -t emacs-copy k cursor-up ; \
   bind -t emacs-copy l cursor-right ;'

if-shell -b 'bash -c "[[ $TMUX_VERSION > 2.4 || $TMUX_VERSION = 2.4 ]]"' \
  'bind-key -T copy-mode C-u send-keys -X page-up ; \
   bind-key -T copy-mode C-d send-keys -X page-down ; \
   bind-key -T copy-mode h send-keys -X cursor-left ; \
   bind-key -T copy-mode j send-keys -X cursor-down ; \
   bind-key -T copy-mode k send-keys -X cursor-up ; \
   bind-key -T copy-mode l send-keys -X cursor-right ;'

# Window title
set -g set-titles on
set -g set-titles-string '#H #I.#P #W'

# set C-c/C-n/C-p/C-[
unbind C-n
bind   C-n next-window
unbind C-p
bind   C-p previous-window
unbind C-c
bind   C-c new-window
unbind C-[
bind   C-[ copy-mode

# pane control bindings (Via: https://github.com/tmux-plugins/tmux-pain-control/ )
bind '#' split-window -h
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# For Mac OSX
if-shell 'uname | grep -qi Darwin && which reattach-to-user-namespace > /dev/null' 'set-option -g default-command "reattach-to-user-namespace -l $SHELL"'

# OSX Clipboard
if-shell 'uname | grep -qi Darwin && which reattach-to-user-namespace > /dev/null' 'bind-key -n -t emacs-copy M-w copy-pipe "reattach-to-user-namespace pbcopy"'
if-shell 'uname | grep -qi Darwin && which reattach-to-user-namespace > /dev/null' 'bind ] run "reattach-to-user-namespace pbpaste | tmux load-buffer - ; tmux paste-buffer"'
